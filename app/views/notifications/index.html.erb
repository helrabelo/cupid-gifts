<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900"><%= t('notifications.title') %></h1>
    <p class="text-gray-600 mt-2"><%= t('notifications.subtitle') %></p>
  </div>

  <% if @notifications.any? %>
    <div class="bg-white rounded-xl shadow-sm border border-rose-100 overflow-hidden">
      <% if @unread_count > 0 %>
        <div class="px-6 py-4 border-b border-rose-50 flex items-center justify-between bg-rose-50">
          <span class="text-sm font-medium text-rose-700">
            <%= t('notifications.unread_count', count: @unread_count) %>
          </span>
          <%= link_to t('notifications.mark_all_read'), mark_all_as_read_notifications_path, 
                data: { "turbo-method": :patch },
                class: "text-sm text-rose-600 hover:text-rose-700 font-medium" %>
        </div>
      <% end %>
      
      <div class="divide-y divide-gray-100">
        <% @notifications.each do |notification| %>
          <div class="<%= 'bg-rose-50/50' unless notification.read? %>">
            <% unless notification.read? %>
              <%= link_to mark_as_read_notification_path(notification), 
                    data: { "turbo-method": :patch },
                    class: "block px-6 py-4 hover:bg-gray-50 transition duration-200" do %>
                <div class="flex items-start gap-4">
                  <div class="flex-shrink-0">
                    <div class="w-3 h-3 mt-1.5 rounded-full bg-rose-500"></div>
                  </div>
                  
                  <div class="flex-1">
                    <h3 class="text-sm font-semibold text-gray-900">
                      <%= notification.localized_title %>
                    </h3>
                    <p class="text-sm text-gray-600 mt-1">
                      <%= notification.localized_message %>
                    </p>
                    <div class="flex items-center gap-4 mt-2">
                      <span class="text-xs text-gray-400">
                        <%= time_ago_in_words(notification.created_at) %> ago
                      </span>
                    </div>
                  </div>
                  
                  <div class="flex-shrink-0">
                    <% case notification.notification_type %>
                    <% when 'invitation_received' %>
                      <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path>
                      </svg>
                    <% when 'invitation_accepted' %>
                      <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      </svg>
                    <% when 'invitation_declined' %>
                      <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      </svg>
                    <% when 'item_purchased' %>
                      <svg class="w-5 h-5 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      </svg>
                    <% else %>
                      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                      </svg>
                    <% end %>
                  </div>
                </div>
              <% end %>
              
              <% if notification.notification_type == 'invitation_received' && notification.data && notification.data['invitation_token'] %>
                <% invitation = Invitation.find_by(token: notification.data['invitation_token']) %>
                <% if invitation && invitation.pending? %>
                  <div class="px-6 pb-4 flex items-center justify-end gap-2">
                    <%= link_to accept_invitation_path(token: notification.data['invitation_token']), 
                          data: { "turbo-method": :patch },
                          class: "p-2 bg-green-100 hover:bg-green-200 rounded-lg transition duration-200",
                          title: t('notifications.actions.accept') do %>
                      <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                      </svg>
                    <% end %>
                    <%= link_to accept_invitation_path(token: notification.data['invitation_token'], accept: false), 
                          data: { "turbo-method": :patch, "turbo-confirm": "Are you sure you want to decline this invitation?" },
                          class: "p-2 bg-red-100 hover:bg-red-200 rounded-lg transition duration-200",
                          title: t('notifications.actions.decline') do %>
                      <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                      </svg>
                    <% end %>
                  </div>
                <% end %>
              <% end %>
            <% else %>
              <div class="px-6 py-4">
                <div class="flex items-start gap-4">
                  <div class="flex-shrink-0">
                    <div class="w-3 h-3 mt-1.5 rounded-full bg-gray-300"></div>
                  </div>
                  
                  <div class="flex-1">
                    <h3 class="text-sm font-semibold text-gray-900">
                      <%= notification.localized_title %>
                    </h3>
                    <p class="text-sm text-gray-600 mt-1">
                      <%= notification.localized_message %>
                    </p>
                    <div class="flex items-center gap-4 mt-2">
                      <span class="text-xs text-gray-400">
                        <%= time_ago_in_words(notification.created_at) %> ago
                      </span>
                    </div>
                  </div>
                  
                  <div class="flex-shrink-0">
                    <% case notification.notification_type %>
                    <% when 'invitation_received' %>
                      <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path>
                      </svg>
                    <% when 'invitation_accepted' %>
                      <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      </svg>
                    <% when 'invitation_declined' %>
                      <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      </svg>
                    <% when 'item_purchased' %>
                      <svg class="w-5 h-5 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      </svg>
                    <% else %>
                      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                      </svg>
                    <% end %>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <div class="bg-white rounded-xl shadow-sm border border-rose-100 p-12 text-center">
      <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path>
      </svg>
      <h3 class="text-lg font-medium text-gray-900 mb-2"><%= t('notifications.empty_state') %></h3>
      <p class="text-gray-500"><%= t('notifications.empty_state_description') %></p>
    </div>
  <% end %>
</div>