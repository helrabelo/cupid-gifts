<!-- Theme & Language Switcher -->
<div class="fixed top-4 right-4 z-50">
  <div class="flex gap-2">
    <!-- Theme Toggle -->
    <div 
      data-controller="theme"
      data-theme-current-value="<%= session[:theme_preference] || 'system' %>"
      data-theme-authenticated-value="false"
    >
      <button 
        data-action="click->theme#toggle"
        data-theme-target="toggle"
        class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition duration-200 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm border shadow-sm border-gray-200 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-700 hover:border-gray-300 dark:hover:border-gray-500"
        title="<%= t('theme.toggle') %>"
      >
        <span data-theme-target="icon" class="text-base">ðŸ”„</span>
        <span data-theme-target="text" class="hidden sm:inline"><%= t('theme.system') %></span>
      </button>
    </div>
    
    <!-- Language Switcher -->
    <% available_locales.each do |locale| %>
      <%= link_to locale_switch_url(locale[:code]), 
            class: "flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition duration-200 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm border shadow-sm #{'border-rose-200 dark:border-rose-600 text-rose-700 dark:text-rose-300 bg-rose-50/80 dark:bg-rose-900/30' if I18n.locale.to_s == locale[:code] && local_assigns[:active_locale_style].blank?} #{local_assigns[:active_locale_style] if I18n.locale.to_s == locale[:code] && local_assigns[:active_locale_style].present?} #{'border-gray-200 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-700 hover:border-gray-300 dark:hover:border-gray-500' unless I18n.locale.to_s == locale[:code]}" do %>
        <span><%= locale[:flag] %></span>
        <span class="hidden sm:inline"><%= locale[:name] %></span>
        <% if I18n.locale.to_s == locale[:code] && local_assigns[:show_checkmark] %>
          <span class="text-blue-600">âœ“</span>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>